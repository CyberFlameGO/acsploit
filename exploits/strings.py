from input import Generator

class StringsExploit():

    options = dict({'algorithm': 'rabinkarp','pattern_length': 5,'string_length' : 10})

    def run(self, generator):
        if self.options['algorithm']=='rabinkarp':
            print(self.RabinKarp(generator, int(self.options['string_length'])))
        elif self.options['algorithm']=='kmp': #Knuth-Morris-Pratt
            print(self.KMP(generator,int(self.options['string_length']), int(self.options['pattern_length'])))


    def KMP( self, generator, string_length, pattern_length):
         base=generator.get_min_value()[0]
         pattern=pattern_length*base
         k= int(string_length/pattern_length)
         whole=k*(pattern[:-1]+generator.get_max_value()[0]) +base*(string_length%pattern_length)
         return "String: " + whole + "\nSearch Pattern: " + pattern   

    # TODO: Check for other algorithms here
    def RabinKarp(self, generator, n_inputs):
        base = generator.get_min_value()[0]
        whole = base * n_inputs
        pattern = base * int(n_inputs / 2)
        return "String: " + whole + "\nSearch pattern: " + pattern
